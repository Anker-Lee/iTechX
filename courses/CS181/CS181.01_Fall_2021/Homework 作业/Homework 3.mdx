«««
code: CS181
name: Artificial Intelligence I
semester: Fall 2021
category: Homework 作业
title: Homework 3
»»»

# Homework 3

## Page 1 (question)

@ Problem - custom

title: "Question 1 - Probability"
content: """
<p>Below is a table listing the probabilities of three binary random variables. In the empty table cells, fill in the correct values for each marginal or conditional probability. Round your answers to 3 decimal places.</p>
<p><img src="image/hw3/xid-1240199_1" height="400" /></p>
<p>Please answer the following expressions:</p>
"""
choice: """
<div class="question q1 q-text" answer="{'0.160': 4}">
    <p style="display: inline;">$P(X_0=1, X_1=1, X_2=0) = $</p>
    <input type="text" name="q1" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q2 q-text" answer="{'0.260': 4}">
    <p style="display: inline;">$P(X_1=0, X_2=1) = $</p>
    <input type="text" name="q2" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q3 q-text" answer="{'0.480': 4}">
    <p style="display: inline;">$P(X_1=1) = $</p>
    <input type="text" name="q3" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q4 q-text" answer="{'0.200': 4}">
    <p style="display: inline;">$P(X_0=1, X_1=0| X_2=1) = $</p>
    <input type="text" name="q4" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q5 q-text" answer="{'0.846': 4}">
    <p style="display: inline;">$P(X_0=1| X_1=0, X_2=0) = $</p>
    <input type="text" name="q5" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
"""



@ Problem - radio

title: "Question 2 - D-seperated"
content: """
<img src="image/hw3/Q2_3.png" height="400" />

It is guaranteed that C is independent of D given E,G
"""
choice:"""
True
False
"""
points: "10"
answer: "A"



@ Problem - radio

title: "Question 3 - D-seperated Part 2"
content: """
<img src="image/hw3/Q2_2N.png" height="400" />

Assertion: It is guaranteed that C is independent of H given A, I.
"""
choice:"""
True
False
"""
points: "10"
answer: "A"



@ Problem - radio

title: "Question 4 - D-seperated Archive"
content: """
<img src="image/hw3/Q2_2.png" height="400" />

It is guaranteed that H is independent of D given I,C,E
"""
choice:"""
True
False
"""
points: "10"
answer: "B"



@ Problem - radio

title: "Question 5 - Combining Factors"
content: """
Given the factors $P(A|B)$ and $P(A|C)$ and $P(B)$ which factor will be created after joining on $B$ and summing out over $B$ ?
"""
choice:"""
$P(A)$
$P(B)$
$P(C)$
$P(B,C)$
"""
points: "10"
answer: "A"



@ Problem - radio

title: "Question 6 - Combining Factors"
content: """
Given the factors $P(A|C)$ and $P(B|A,C)$ , what is the resulting factor after joining over $C$ ?
"""
choice:"""
$P(A,B,C)$
$P(A,B|C)$
$P(A|B,C)$
None of the above
"""
points: "10"
answer: "B"



@ Problem - radio

title: "Question 7 - Markov Network"
content: """
<p>For four random variables, there exists a Markov Network to represent it as:</p>
<p><img src="image/hw3/xid-1240208_1" height="400" /></p>
<p>Please choose the Bayesian Network that can precisely (no more, no less) represent the distribution of this Markov Network from the two models:</p>
<p style="display: inline;"><img src="image/hw3/xid-1240209_1" /></p>
<p style="display: inline;"><img src="image/hw3/xid-1240210_1" /></p>
"""
choice:"""
the first model
the second model
both of them
neither of them
"""
points: "10"
answer: "D"


## Page 2 (question)


@ Problem - custom

title: "Question 8 - Variable Elimination Tables"
content: """
<p>Assume the following Bayes Net and corresponding CPTs. In this exercise, we are given the query $P(C|e=1)$ , and we will complete the tables for each factor generated during the elimination process.</p>
<p><img width="136" height="360" src="./image/hw3/xid-1240211_1"></p>
<p>After introducing evidence, we have the following probability tables.</p>
<p><img style="max-width: 95%;" src="./image/hw3/xid-1240212_1"></p>
<p>Three steps are required for elimination, with the resulting factors listed below:</p>
<ol style="padding-left: 20px;">
    <li style="list-style: decimal; margin-bottom: 0.70788em; line-height: 1.4em;">Eliminate $A$ . We get the factor $f_1(B)=\sum_{a} P(a)P(B|a)$ .</li>
    <li style="list-style: decimal; margin-bottom: 0.70788em; line-height: 1.4em;">Eliminate $B$ . We get the factor $f_2(C,D)=\sum_{b} P(C|b)P(D|b)f_1(b)$ .</li>
    <li style="list-style: decimal; margin-bottom: 0.70788em; line-height: 1.4em;">Eliminate $D$ . We get the factor $f_3(C,e=1)=\sum_{d} P(e=1|C,d)f_2(C,d)$ .</li>
</ol>
<p>Complete the tables below for the factors generated during elimination. Some values have been evaluated for you, note that these values are precise and feel free to use them. You should also fill precise values in the blanks, and round to a fixed number of decimal places (the same or potentially more digits than actually required and have trailing zeros).</p>
<p><img width="917" height="252" src="./image/hw3/xid-1419783_1"></p>
"""
choice:"""
<p>For the following 2 blanks, fill in the <b>precise values</b> and round to <b>2 decimal places</b>.</p>
<div class="question q1 q-text" answer="{'0.68': 4}">
    <p style="display: inline;">Blank 1 = </p>
    <input type="text" name="q1" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q2 q-text" answer="{'0.32': 4}">
    <p style="display: inline;">Blank 2 = </p>
    <input type="text" name="q2" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<p>For the following 2 blanks, fill in the <b>precise values</b> and round to <b>4 decimal places</b>.</p>
<div class="question q3 q-text" answer="{'0.0944': 4}">
    <p style="display: inline;">Blank 3 = </p>
    <input type="text" name="q3" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q4 q-text" answer="{'0.1416': 4}">
    <p style="display: inline;">Blank 4 = </p>
    <input type="text" name="q4" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<p>For the following 2 blanks, fill in the <b>precise values</b> and round to <b>5 decimal places</b>.</p>
<div class="question q5 q-text" answer="{'0.16000': 4}">
    <p style="display: inline;">Blank 5 = </p>
    <input type="text" name="q5" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<p>After getting the final factor $P(C|e=1)$ ,  a final renormalization step needs be carried out to obtain the conditional probability $P(C|e=1)$ . Please fill into the table below. These values are not necessarily precise.</p>
<p><img width="298" height="182" src="./image/hw3/xid-1240215_1"></p>
<p>Round your answers to <b>3 decimal places</b>.</p>
<div class="question q6 q-text" answer="{'0.475': 5}">
    <p style="display: inline;">Blank 6 = </p>
    <input type="text" name="q6" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q7 q-text" answer="{'0.525': 5}">
    <p style="display: inline;">Blank 7 = </p>
    <input type="text" name="q7" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
"""



@ Problem - text

title: "Question 9 - Eliminating Probabilities from Samples"
content: """
<p>Below are a set of samples obtained by running rejection sampling for the Bayes' net from the previous question. Use them to estimate $P(D=1|B=0, E=1)$ and round to 3 decimal places. If the estimation cannot be made, input -1.</p>
<p><img height="298" src="./image/hw3/q11.png"></p>
"""
points: "10"
answer: "0.667"



@ Problem - text

title: "Question 10 - Eliminating Probabilities from Weighted Samples"
content: """
<p>Below are a set of samples obtained by running rejection sampling for the Bayes' net from the previous question. Use them to estimate $P(D=1|B=0, E=1)$ and round to 3 decimal places. If the estimation cannot be made, input -1.</p>
<p><img height="298" src="./image/hw3/q13.png"></p>
"""
points: "10"
answer: "0.833"


## Page 3 (question)


@ Problem - custom

title: "Question 11 - Bayes' Nets and Probability"
content: """
<p>Suppose that a patient can have a symptom (S) that can be caused by two different diseases (A and B). It is known that the variation of gene G plays a big role in the manifestation of disease A. The Bayes' Net and corresponding probability tables for this situation are shown below.</p>
<p><img width=60% src="./image/hw3/hw6_q5.png"></p>
"""
choice:"""
<div class="question q1 q-text" answer="{'0.04':3.33}">
    <p>a: Compute $P(g,a,b,s)$. Round your answers to 2 decimal places.</p>
    <input type="text" name="q1" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q2 q-text" answer="{'0.19':3.33}">
    <p>b: What is the probability that a patient has disease A?  Round your answers to 2 decimal places.</p>
    <input type="text" name="q2" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q3 q-text" answer="{'0.19':3.34}">
    <p>c: What is the probability that a patient has disease A given that they have disease B?  Round your answers to 2 decimal places.</p>
    <input type="text" name="q3" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q4 q-text" answer="{'0.2267':3.33}">
    <p>d: What is the probability that a patient has disease A given that they have symptom S and disease B?  Round your answers to 4 decimal places.</p>
    <input type="text" name="q4" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q5 q-text" answer="{'0.562':3.33}">
    <p>e: What is the probability that a patient has the disease carrying gene variation G given that they have disease A?  Round your answers to 3 decimal places.</p>
    <input type="text" name="q5" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q6 q-text" answer="{'0.1':3.34}">
    <p>f: What is the probability that a patient has the disease carrying gene variation G given that they have disease B?  Round your answers to 1 decimal places.</p>
    <input type="text" name="q6" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
"""



@ Problem - custom

title: "Question 12 - Reject Sampling"
content: """
We will work with a Bayes' net of the following structure. 

<p><img width="136" height="360" src="./image/hw3/xid-1240211_1"></p>

In this question, we will perform rejection sampling to estimate $P(D|B=0,E=1)$. Perform one round of rejection sampling, using the random samples given in the table below. Variables are sampled in the order A, B, C, D, E. In the boxes below, choose the value (0 or 1) that each variable gets assigned to.

**Note that the sampling attempt should stop as soon as you discover that the sample will be rejected.** In that case, mark the assignment of that variable and leave the boxes corresponding to the rest of the variables blank.

To generate random samples, use as many values as needed from the table below, which we generated independently and uniformly at random from 0 to 1. Use numbers from left to right. To sample a binary variable $W$ with probability $P(W=0)=p$, select a value $a$ from the table, and choose $W=1$ if $a\ge p$ and $W=0$ otherwise.

|0.426|0.348|0.584|0.913|0.637|0.885|0.479|0.670|0.402|0.882|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|


|$A$| $P(A)$ |
|:--:|:------:|
| 0 |  0.3   |
| 1 |  0.7   |


|$B$|$A$|$P(B\|A)$|
|:--:|:--:|:--:|
|0|0|0.2|
|1|0|0.8|
|0|1|0.4|
|1|1|0.6|

|$C$|$B$|$P(C\|B)$|
|:--:|:--:|:--:|
|0|0|0.5|
|1|0|0.5|
|0|1|0.1|
|1|1|0.9|

|$D$|$B$|$P(D\|B)$|
|:--:|:--:|:--:|
|0|0|0.6|
|1|0|0.4|
|0|1|0.3|
|1|1|0.7|

|$E$|$C$|$D$|$P(E\|C,D)$|
|:--:|:--:|:--:|:--:|
|0|0|0|0.7|
|1|0|0|0.3|
|0|1|0|0.6|
|1|1|0|0.4|
|0|0|1|0.5|
|1|0|1|0.5|
|0|1|1|0.9|
|1|1|1|0.1|

"""
choice:"""
<p>Enter either a 0 or 1 for each variable that you assign a value to. Upon rejecting a sample, enter its assigned value, and leave the fields for the remaining variables blank. For example, if C gets rejected, do not fill in any values for D and E.</p>
<div class="question q1 q-text" answer="{'1': 1.5}">
    <p style="display: inline;">A = </p>
    <input type="text" name="q1" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q2 q-text" answer="{'0': 1.5}">
    <p style="display: inline;">B = </p>
    <input type="text" name="q2" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q3 q-text" answer="{'1': 1.5}">
    <p style="display: inline;">C = </p>
    <input type="text" name="q3" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q4 q-text" answer="{'1': 1.5}">
    <p style="display: inline;">D = </p>
    <input type="text" name="q4" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q5 q-text" answer="{'0': 1.5}">
    <p style="display: inline;">E = </p>
    <input type="text" name="q5" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<p>Which variable will get rejected? If no variables will get rejected, leave the field below blank.</p>
<div class="question q6 q-text" answer="{'E': 2.5}">
    <input type="text" name="q6" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
"""



@ Problem - custom

title: "Question 13 - Likelyhood Weighting"
content: """
We will work with a Bayes' net of the following structure. 

<p><img width="136" height="360" src="./image/hw3/xid-1240211_1"></p>

In this question, we will perform likelihood weighting to estimate $P(D|B=0,E=1)$. Generate a sample and its weight, using the random samples given in the table below. Variables are sampled in the order A, B, C, D, E. In the table below, select the assignments to the variables you sampled.

To generate random samples, use as many values as needed from the table below, which we generated independently and uniformly at random from 0 to 1. Use numbers from left to right. To sample a binary variable $W$ with probability $P(W=0)=p$, select a value $a$ from the table, and choose $W=1$ if $a\ge p$ and $W=0$ otherwise.

|0.123|0.822|0.170|0.626|0.593|0.261|0.558|0.064|0.796|0.178|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|


|$A$| $P(A)$ |
|:--:|:------:|
| 0 |  0.3   |
| 1 |  0.7   |


|$B$|$A$|$P(B\|A)$|
|:--:|:--:|:--:|
|0|0|0.2|
|1|0|0.8|
|0|1|0.4|
|1|1|0.6|

|$C$|$B$|$P(C\|B)$|
|:--:|:--:|:--:|
|0|0|0.5|
|1|0|0.5|
|0|1|0.1|
|1|1|0.9|

|$D$|$B$|$P(D\|B)$|
|:--:|:--:|:--:|
|0|0|0.6|
|1|0|0.4|
|0|1|0.3|
|1|1|0.7|

|$E$|$C$|$D$|$P(E\|C,D)$|
|:--:|:--:|:--:|:--:|
|0|0|0|0.7|
|1|0|0|0.3|
|0|1|0|0.6|
|1|1|0|0.4|
|0|0|1|0.5|
|1|0|1|0.5|
|0|1|1|0.9|
|1|1|1|0.1|

"""
choice:"""
<p>Enter either a 0 or 1 for each variable assigned by a pass of likelihood weighting with the generated samples above.</p>
<div class="question q1 q-text" answer="{'0': 1.5}">
    <p style="display: inline;">A = </p>
    <input type="text" name="q1" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q2 q-text" answer="{'0': 1.5}">
    <p style="display: inline;">B = </p>
    <input type="text" name="q2" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q3 q-text" answer="{'1': 1.5}">
    <p style="display: inline;">C = </p>
    <input type="text" name="q3" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q4 q-text" answer="{'0': 1.5}">
    <p style="display: inline;">D = </p>
    <input type="text" name="q4" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<div class="question q5 q-text" answer="{'1': 1.5}">
    <p style="display: inline;">E = </p>
    <input type="text" name="q5" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
<p>What is the weight for the sample you obtained above? Round your answer to 2 decimal places.</p>
<div class="question q6 q-text" answer="{'0.08': 2.5}">
    <input type="text" name="q6" placeholder="" class="layui-input" style="display: inline;">
    <p class="tick-label" style="display: inline;"></p>
</div>
"""