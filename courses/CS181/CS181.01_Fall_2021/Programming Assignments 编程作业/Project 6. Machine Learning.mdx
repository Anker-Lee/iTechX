«««
code: CS181
name: Artificial Intelligence I
semester: Fall 2021
category: Programming Assignments 编程作业
title: Project 6. Machine Learning
»»»

# Project 6. Machine Learning

## Page 1 (book)

@ Reading

<style type="text/css">
    pre {
        max-width: inherit;
    }
    ul{
        padding-left: 40px;
    }
    li{
        list-style: inherit;
    }
</style>

<h2 style="font-family: Quicksand; font-weight: bold; text-align: left; margin-bottom:1rem;">Introduction</h2>

<center><img src="https://inst.eecs.berkeley.edu/~cs188/sp20/assets/images/ml_project_teaser.png" alt="Machine Learning!" width="400" /></center>
<p><span style="font-size: medium;">In this project you will build a neural network to classify digits, and more!</span></p>
<p style="color: #3c3c3c; font-style: normal; font-variant: normal; font-weight: 600; font-stretch: normal; font-size: 1.2em; line-height: 1.4em; font-family: 'Open Sans', Verdana, Geneva, sans-serif, sans-serif; margin: 0px 0px 10px; text-align: left;"><span style="font-size: large;">Introduction</span></p>
<p><span style="font-size: medium;">This project will be an introduction to machine learning.</span></p>
<p><span style="font-size: medium;"> The code for this project contains the following files, available in <a href="machinelearning.zip">machinelearning.zip</a>.</span></p>
<p></p>
<table class="table table-bordered" style="box-sizing: border-box; border-collapse: collapse; border: 1px solid #dee2e6; width: 802px; margin-bottom: 1rem; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<tbody style="box-sizing: border-box;">
<tr style="box-sizing: border-box;">
<td colspan="2" style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top;"><b style="box-sizing: border-box; font-weight: bolder;">Files you'll edit:</b></td>
</tr>
<tr style="box-sizing: border-box;">
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">models.py</code></td>
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top;">Perceptron and neural network models for a variety of applications</td>
</tr>
<tr style="box-sizing: border-box;">
<td colspan="2" style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top;"><b style="box-sizing: border-box; font-weight: bolder;">Files you should read but NOT edit:</b></td>
</tr>
<tr style="box-sizing: border-box;">
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">nn.py</code></td>
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top;">Neural network mini-library</td>
</tr>
<tr style="box-sizing: border-box;">
<td colspan="2" style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top;"><b style="box-sizing: border-box; font-weight: bolder;">Files you will not edit:</b></td>
</tr>
<tr style="box-sizing: border-box;">
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">autograder.py</code></td>
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top;">Project autograder</td>
</tr>
<tr style="box-sizing: border-box;">
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">backend.py</code></td>
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top;">Backend code for various machine learning tasks</td>
</tr>
<tr style="box-sizing: border-box;">
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">data</code></td>
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top;">Datasets for digit classification and language identification</td>
</tr>
<tr style="box-sizing: border-box;">
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top;"><span style="text-decoration: line-through;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5); text-decoration: line-through;">submission_autograder.py</code></span></td>
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top;"><span style="text-decoration: line-through;">Submission autograder (generates tokens for submission)</span></td>
</tr>
</tbody>
</table>
<p></p>
<p style="color: #3c3c3c; margin: 20px 0px 1.41575em; text-align: left; font-family: 'Open Sans', Verdana, Geneva, sans-serif, sans-serif; line-height: 1.6em !important; font-size: 1em;"><strong style="font-weight: bold; line-height: 1.4em;">Files to Edit and Submit:</strong><span class="Apple-converted-space" style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 16px;"> </span>You will fill in portion of<span class="Apple-converted-space" style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 16px;"> </span><code><strong>models.py</strong> </code>during the assignment. </p>
<p style="color: #3c3c3c; margin: 20px 0px 1.41575em; text-align: left; font-family: 'Open Sans', Verdana, Geneva, sans-serif, sans-serif; line-height: 1.6em !important; font-size: 1em;"><span style="font-size: medium;">This time, please submit <strong>models.py</strong> directly to autolab, do NOT submit a .tar file!</span></p>
<p style="margin: 0px 0px 1em; padding: 0px; border: 0px; outline: 0px; font-weight: 400; font-style: normal; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; color: #000000; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><span style="font-size: medium;">You need to submit your solution to our Autolab server, you can visit it at <a href="http://10.19.127.41/">http://10.19.127.41/</a>. If you have any question or find any bug of the platform, feel free to contact us. It is recommended to access the website using a proxy. The email system may be slow and you may need to wait for a few minutes to receive your registration email. Please see the announcement on Piazza and BB for detailed instruction of how to register your account.</span><span style="color: #0000ff;"><span style="color: #000000;"></span></span></p>
<p style="margin: 0px 0px 1em; padding: 0px; border: 0px; outline: 0px; font-weight: 400; font-style: normal; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; color: #000000; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><span style="font-size: medium;"><strong>Warning:</strong> This programming assignment may cost a lot of time to run. To make autolab available, we set a time limit (10 min) to each submission. If you see something like "time out" in your feedback, most likely the autolab is fine and you need to go back and optimize your algorithm.</span></p>
<p style="margin: 0px 0px 1em; padding: 0px; border: 0px; outline: 0px; font-weight: 400; font-style: normal; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; color: #000000; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><span style="font-size: medium;">To estimate your running time, please disable the visualization by running:</span></p>
<p style="margin: 0px 0px 1em; padding: 0px; border: 0px; outline: 0px; font-weight: 400; font-style: normal; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; color: #000000; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><span style="font-size: medium;">       python3 autograder.py --no-graphics --mute</span></p>
<p style="margin: 0px 0px 1em; padding: 0px; border: 0px; outline: 0px; font-weight: 400; font-style: normal; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; color: #000000; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><span style="font-size: medium;">With graphics off, your program should finish in 3-5min, otherwise it is normal to cost around 10min.</span></p>
<p style="color: #3c3c3c; margin: 20px 0px 1.41575em; text-align: left; font-family: 'Open Sans', Verdana, Geneva, sans-serif, sans-serif; line-height: 1.6em !important; font-size: 1em;"><strong style="font-weight: bold; line-height: 1.4em;">Evaluation:</strong><span class="Apple-converted-space" style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 16px;"> </span>Your code will be autograded for technical correctness. Please<span class="Apple-converted-space" style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 16px;"> </span><em style="line-height: 1.4em; font-style: italic;">do not</em><span class="Apple-converted-space" style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 16px;"> </span>change the names of any provided functions or classes within the code, or you will wreak havoc on the autograder. However, the correctness of your implementation -- not the autograder's judgements -- will be the final judge of your score. If necessary, we will review and grade assignments individually to ensure that you receive due credit for your work. Notice that we reserve the right to give 0 points to solutions that try to cheat the autograder. For example, using a pre-trained neural network instead of real training. So please just follow the instructions and optimize your code as much as you can.</p>
<p style="color: #3c3c3c; margin: 20px 0px 1.41575em; text-align: left; font-family: 'Open Sans', Verdana, Geneva, sans-serif, sans-serif; line-height: 1.6em !important; font-size: 1em;"><strong style="font-weight: bold; line-height: 1.4em;">Academic Dishonesty:</strong><span class="Apple-converted-space" style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 16px;"> </span>We will be checking your code against other submissions in the class for logical redundancy. If you copy someone else's code and submit it with minor changes, we will know. These cheat detectors are quite hard to fool, so please don't try. We trust you all to submit your own work only;<span class="Apple-converted-space" style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 16px;"> </span><em style="line-height: 1.4em; font-style: italic;">please</em>don't let us down. If you do, we will pursue the strongest consequences available to us.</p>
<p style="color: #3c3c3c; margin: 20px 0px 1.41575em; text-align: left; font-family: 'Open Sans', Verdana, Geneva, sans-serif, sans-serif; line-height: 1.6em !important; font-size: 1em;"><strong style="font-weight: bold; line-height: 1.4em;">Getting Help:</strong><span class="Apple-converted-space" style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 16px;"> </span>You are not alone! If you find yourself stuck on something, contact the course staff for help. Office hours, section, and the discussion forum are there for your support; please use them. If you can't make our office hours, let us know and we will schedule more. We want these projects to be rewarding and instructional, not frustrating and demoralizing. But, we don't know when or how to help unless you ask.</p>
<p style="color: #3c3c3c; margin: 20px 0px 1.41575em; text-align: left; font-family: 'Open Sans', Verdana, Geneva, sans-serif, sans-serif; line-height: 1.6em !important; font-size: 1em;"><strong style="font-weight: bold; line-height: 1.4em;">Discussion:</strong><span class="Apple-converted-space" style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 16px;"> </span>Please be careful not to post spoilers.</p>
<p><br /> </p>
<p></p>
<p></p>

## Page 2 (book)

@ Reading

<h2 style="font-family: Quicksand; font-weight: bold; text-align: left; margin-bottom:1rem;">Installation</h2>

<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">For this project, you will need to install the following two libraries:</p>
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;"><a href="http://www.numpy.org/" style="box-sizing: border-box; color: #006cb8; text-decoration: none; background-color: transparent;">numpy</a>, which provides support for large multi-dimensional arrays - <a href="https://docs.scipy.org/doc/numpy-1.13.0/user/install.html" style="box-sizing: border-box; color: #006cb8; text-decoration: none; background-color: transparent;">installation instructions</a></li>
<li style="box-sizing: border-box;"><a href="https://matplotlib.org/" style="box-sizing: border-box; color: #006cb8; text-decoration: none; background-color: transparent;">matplotlib</a>, a 2D plotting library - <a href="https://matplotlib.org/users/installing.html" style="box-sizing: border-box; color: #006cb8; text-decoration: none; background-color: transparent;">installation instructions</a></li>
</ul>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">If you have a conda environment, you can install both packages on the command line by running:</p>
<div class="language-shell highlighter-rouge" style="box-sizing: border-box; overflow-wrap: break-word; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<div class="highlight" style="box-sizing: border-box; overflow-wrap: break-word; background: #f8f8f8; position: relative;">
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;">conda activate <span class="nt" style="box-sizing: border-box; color: #22863a;">[your environment name]</span></code></pre>
</div>
</div>
<div class="language-shell highlighter-rouge" style="box-sizing: border-box; overflow-wrap: break-word; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<div class="highlight" style="box-sizing: border-box; overflow-wrap: break-word; background: #f8f8f8; position: relative;">
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;">pip install numpy</code></pre>
</div>
</div>
<div class="language-shell highlighter-rouge" style="box-sizing: border-box; overflow-wrap: break-word; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<div class="highlight" style="box-sizing: border-box; overflow-wrap: break-word; background: #f8f8f8; position: relative;">
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;">pip install matplotlib</code></pre>
</div>
</div>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">You will not be using these libraries directly, but they are required in order to run the provided code and autograder.</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">To test that everything has been installed, run:</p>
<div class="language-shell highlighter-rouge" style="box-sizing: border-box; overflow-wrap: break-word; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<div class="highlight" style="box-sizing: border-box; overflow-wrap: break-word; background: #f8f8f8; position: relative;">
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;">python autograder.py <span class="nt" style="box-sizing: border-box; color: #22863a;">--check-dependencies</span></code></pre>
</div>
</div>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">If <code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">numpy</code> and <code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">matplotlib</code> are installed correctly, you should see a window pop up where a line segment spins in a circle:</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><img src="https://inst.eecs.berkeley.edu/~cs188/sp20/assets/images/check_dependencies_spinner.png" alt="Matplotlib straight line graph" class="img-fluid center-image" style="box-sizing: border-box; vertical-align: middle; border-style: none; max-width: 100%; height: auto; margin: 0px auto; display: block; width: 600px;" /></p>
<p><br /> </p>

## Page 3 (book)

@ Reading

<h2 style="font-family: Quicksand; font-weight: bold; text-align: left; margin-bottom:1rem;">Provided Code (Part I)</h2>

<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">For this project, you have been provided with a neural network mini-library (<code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">nn.py</code>) and a collection of datasets (<code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">backend.py</code>).</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">The library in <code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">nn.py</code> defines a collection of node objects. Each node represents a real number or a matrix of real numbers. Operations on node objects are optimized to work faster than using Python’s built-in types (such as lists).</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Here are a few of the provided node types:</p>
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;"><code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">nn.Constant</code> represents a matrix (2D array) of floating point numbers. It is typically used to represent input features or target outputs/labels. Instances of this type will be provided to you by other functions in the API; you will not need to construct them directly.</li>
<li style="box-sizing: border-box;"><code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">nn.Parameter</code> represents a trainable parameter of a perceptron or neural network.</li>
<li style="box-sizing: border-box;"><code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">nn.DotProduct</code> computes a dot product between its inputs.</li>
</ul>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Additional provided functions:</p>
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;"><code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">nn.as_scalar</code> can extract a Python floating-point number from a node.</li>
</ul>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">When training a perceptron or neural network, you will be passed a <code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">dataset</code> object. You can retrieve batches of training examples by calling <code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">dataset.iterate_once(batch_size)</code>:</p>
<div class="language-python highlighter-rouge" style="box-sizing: border-box; overflow-wrap: break-word; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<div class="highlight" style="box-sizing: border-box; overflow-wrap: break-word; background: #f8f8f8; position: relative;">
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;"><span class="k" style="box-sizing: border-box; color: #d73a49;">for</span> <span class="n" style="box-sizing: border-box;">x</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">y</span> <span class="ow" style="box-sizing: border-box; color: #d73a49;">in</span> <span class="n" style="box-sizing: border-box;">dataset</span><span class="o" style="box-sizing: border-box;">.</span><span class="n" style="box-sizing: border-box;">iterate_once</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">batch_size</span><span class="p" style="box-sizing: border-box;">):</span>
<span class="o" style="box-sizing: border-box;">...</span></code></pre>
</div>
</div>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">For example, let’s extract a batch of size 1 (i.e., a single training example) from the perceptron training data:</p>
<div class="language-python highlighter-rouge" style="box-sizing: border-box; overflow-wrap: break-word; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<div class="highlight" style="box-sizing: border-box; overflow-wrap: break-word; background: #f8f8f8; position: relative;">
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;"><span class="o" style="box-sizing: border-box;">&gt;&gt;&gt;</span> <span class="n" style="box-sizing: border-box;">batch_size</span> <span class="o" style="box-sizing: border-box;">=</span> <span class="mi" style="box-sizing: border-box; color: #005cc5;">1</span>
<span class="o" style="box-sizing: border-box;">&gt;&gt;&gt;</span> <span class="k" style="box-sizing: border-box; color: #d73a49;">for</span> <span class="n" style="box-sizing: border-box;">x</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">y</span> <span class="ow" style="box-sizing: border-box; color: #d73a49;">in</span> <span class="n" style="box-sizing: border-box;">dataset</span><span class="o" style="box-sizing: border-box;">.</span><span class="n" style="box-sizing: border-box;">iterate_once</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">batch_size</span><span class="p" style="box-sizing: border-box;">):</span>
<span class="o" style="box-sizing: border-box;">...</span>     <span class="k" style="box-sizing: border-box; color: #d73a49;">print</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">x</span><span class="p" style="box-sizing: border-box;">)</span>
<span class="o" style="box-sizing: border-box;">...</span>     <span class="k" style="box-sizing: border-box; color: #d73a49;">print</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">y</span><span class="p" style="box-sizing: border-box;">)</span>
<span class="o" style="box-sizing: border-box;">...</span>     <span class="k" style="box-sizing: border-box; color: #d73a49;">break</span>
<span class="o" style="box-sizing: border-box;">...</span>
<span class="o" style="box-sizing: border-box;">&lt;</span><span class="n" style="box-sizing: border-box;">Constant</span> <span class="n" style="box-sizing: border-box;">shape</span><span class="o" style="box-sizing: border-box;">=</span><span class="mi" style="box-sizing: border-box; color: #005cc5;">1</span><span class="n" style="box-sizing: border-box;">x3</span> <span class="n" style="box-sizing: border-box;">at</span> <span class="mh" style="box-sizing: border-box; color: #005cc5;">0x11a8856a0</span><span class="o" style="box-sizing: border-box;">&gt;</span>
<span class="o" style="box-sizing: border-box;">&lt;</span><span class="n" style="box-sizing: border-box;">Constant</span> <span class="n" style="box-sizing: border-box;">shape</span><span class="o" style="box-sizing: border-box;">=</span><span class="mi" style="box-sizing: border-box; color: #005cc5;">1</span><span class="n" style="box-sizing: border-box;">x1</span> <span class="n" style="box-sizing: border-box;">at</span> <span class="mh" style="box-sizing: border-box; color: #005cc5;">0x11a89efd0</span><span class="o" style="box-sizing: border-box;">&gt;</span></code></pre>
</div>
</div>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">The input features <code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">x</code> and the correct label <code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">y</code> are provided in the form of <code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">nn.Constant</code> nodes. The shape of <code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">x</code> will be <code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">batch_size x num_features</code>, and the shape of <code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">y</code> is <code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">batch_size x num_outputs</code>. Here is an example of computing a dot product of <code class="highlighter-rouge" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">x</code> with itself, first as a node and then as a Python number.</p>
<div class="language-python highlighter-rouge" style="box-sizing: border-box; overflow-wrap: break-word; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<div class="highlight" style="box-sizing: border-box; overflow-wrap: break-word; background: #f8f8f8; position: relative;">
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;"><span class="o" style="box-sizing: border-box;">&gt;&gt;&gt;</span> <span class="n" style="box-sizing: border-box;">nn</span><span class="o" style="box-sizing: border-box;">.</span><span class="n" style="box-sizing: border-box;">DotProduct</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">x</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">x</span><span class="p" style="box-sizing: border-box;">)</span>
<span class="o" style="box-sizing: border-box;">&lt;</span><span class="n" style="box-sizing: border-box;">DotProduct</span> <span class="n" style="box-sizing: border-box;">shape</span><span class="o" style="box-sizing: border-box;">=</span><span class="mi" style="box-sizing: border-box; color: #005cc5;">1</span><span class="n" style="box-sizing: border-box;">x1</span> <span class="n" style="box-sizing: border-box;">at</span> <span class="mh" style="box-sizing: border-box; color: #005cc5;">0x11a89edd8</span><span class="o" style="box-sizing: border-box;">&gt;</span>
<span class="o" style="box-sizing: border-box;">&gt;&gt;&gt;</span> <span class="n" style="box-sizing: border-box;">nn</span><span class="o" style="box-sizing: border-box;">.</span><span class="n" style="box-sizing: border-box;">as_scalar</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">nn</span><span class="o" style="box-sizing: border-box;">.</span><span class="n" style="box-sizing: border-box;">DotProduct</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">x</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">x</span><span class="p" style="box-sizing: border-box;">))</span>
<span class="mf" style="box-sizing: border-box; color: #005cc5;">1.9756581717465536</span></code></pre>
</div>
</div>
<p><br class="Apple-interchange-newline" /><br /></p>
<p></p>

## Page 4 (book)

@ Reading

<h2 style="font-family: Quicksand; font-weight: bold; text-align: left; margin-bottom:1rem;">Question 1 (6 points): Perceptron</h2>

<p><span style="font-size: medium;"><em>Before starting this part, be sure you have <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">numpy</code> and <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">matplotlib</code> installed!</em></span></p>
<p><span style="font-size: medium;">In this part, you will implement a binary perceptron. Your task will be to complete the implementation of the <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">PerceptronModel</code> class in <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">models.py</code>.</span></p>
<p><span style="font-size: medium;">For the perceptron, the output labels will be either 1 or -1, meaning that data points <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">(x, y)</code> from the dataset will have <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">y</code> be a <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.Constant</code> node that contains either 1 or -1 as its entries.</span></p>
<p><span style="font-size: medium;">We have already initialized the perceptron weights <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">self.w</code> to be a $1 \times \text{dimensions}$ parameter node. The provided code will include a bias feature inside <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">x</code> when needed, so you will not need a separate parameter for the bias.</span></p>
<p><span style="font-size: medium;">Your tasks are to:</span></p>
<ul>
<li><span style="font-size: medium;">Implement the <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">run(self, x)</code> method. This should compute the dot product of the stored weight vector and the given input, returning an <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.DotProduct</code> object.</span></li>
<li><span style="font-size: medium;">Implement <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">get_prediction(self, x)</code>, which should return 1 if the dot product is non-negative or -1 otherwise. You should use <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.as_scalar</code> to convert a scalar <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">Node</code> into a Python floating-point number.</span></li>
<li><span style="font-size: medium;">Write the <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">train(self)</code> method. This should repeatedly loop over the data set and make updates on examples that are misclassified. Use the <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">update</code> method of the <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.Parameter</code> class to update the weights. When an entire pass over the data set is completed without making any mistakes, 100% training accuracy has been achieved, and training can terminate.</span></li>
</ul>
<p><span style="font-size: medium;">In this project, the only way to change the value of a parameter is by calling <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">parameter.update(direction, multiplier)</code>, which will perform the update to the weights: $\text{weights} \leftarrow \text{weights} + \text{direction} \cdot \text{multiplier}$ The <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">direction</code> argument is a <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">Node</code> with the same shape as the parameter, and the <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">multiplier</code> argument is a Python scalar.</span></p>
<p><span style="font-size: medium;">To test your implementation, run the autograder:</span></p>
<div class="language-shell highlighter-rouge">
<div class="highlight">
<pre class="highlight"><span style="font-size: medium;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);">python autograder.py <span class="nt">-q</span> q1 </code></span></pre>
</div>
</div>
<p><span style="font-size: medium;"><strong>Note:</strong> the autograder should take at most 20 seconds or so to run for a correct implementation. If the autograder is taking forever to run, your code probably has a bug.</span></p>
<p></p>
<div id="gtx-trans" style="position: absolute; left: 654px; top: 145.667px;">
<div class="gtx-trans-icon"></div>
</div>

## Page 5 (book)

@ Reading

<h2 style="font-family: Quicksand; font-weight: bold; text-align: left; margin-bottom:1rem;">Neural Network Tips</h2>

<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">In the remaining parts of the project, you will implement the following models:</p>
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;">Q2: Regression</li>
<li style="box-sizing: border-box;">Q3: Handwritten Digit Classification</li>
<li style="box-sizing: border-box;">Q4: Language Identification</li>
</ul>
<h4 style="box-sizing: border-box; margin: 1.2em 0px 0.6em; font-weight: bold; line-height: 20.976px; font-size: 1.15em; color: #333333; font-family: Lato; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" id="building-neural-nets">Building Neural Nets</h4>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Throughout the applications portion of the project, you'll use the framework provided in <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.py</code> to create neural networks to solve a variety of machine learning problems. A simple neural network has layers, where each layer performs a linear operation (just like perceptron). Layers are separated by a <em style="box-sizing: border-box;">non-linearity</em>, which allows the network to approximate general functions. We'll use the ReLU operation for our non-linearity, defined as $ relu(x) = \max(x, 0)$. For example, a simple two-layer neural network for mapping an input row vector $ \mathbf{x}$ to an output vector $ \mathbf{f}(\mathbf{x})$ would be given by the function:</p>
<div style="text-align: center;">$ \mathbf{f}(\mathbf{x}) = relu(\mathbf{x} \cdot \mathbf{W_1} + \mathbf{b_1}) \cdot \mathbf{W_2} + \mathbf{b}_2 $</div>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">where we have parameter matrices $ \mathbf{W_1}$ and $ \mathbf{W_2}$ and parameter vectors $ \mathbf{b}_1$ and $ \mathbf{b}_2$ to learn during gradient descent. $ \mathbf{W_1}$ will be an $ i \times h$ matrix, where $ i$ is the dimension of our input vectors $ \mathbf{x}$, and $ h$ is the <em style="box-sizing: border-box;">hidden layer size</em>. $ \mathbf{b_1}$ will be a size $ h$ vector. We are free to choose any value we want for the hidden size (we will just need to make sure the dimensions of the other matrices and vectors agree so that we can perform the operations). Using a larger hidden size will usually make the network more powerful (able to fit more training data), but can make the network harder to train (since it adds more parameters to all the matrices and vectors we need to learn), or can lead to overfitting on the training data. </p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">We can also create deeper networks by adding more layers, for example a three-layer net:</p>
<div style="text-align: center;">$  \mathbf{f}(\mathbf{x}) = relu(relu(\mathbf{x} \cdot \mathbf{W_1} + \mathbf{b_1}) \cdot \mathbf{W_2} + \mathbf{b}_2) \cdot \mathbf{W_3} + \mathbf{b_3} $</div>
<h4 style="box-sizing: border-box; margin: 1.2em 0px 0.6em; font-weight: bold; line-height: 20.976px; font-size: 1.15em; color: #333333; font-family: Lato; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" id="note-on-batching">Note on Batching</h4>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">For efficiency, you will be required to process whole batches of data at once rather than a single example at a time. This means that instead of a single input row vector $ x$ with size $ i$, you will be presented with a batch of $ b$ inputs represented as a $ b \times i$ matrix $ X$. We provide an example for linear regression to demonstrate how a linear layer can be implemented in the batched setting.</p>
<h4 style="box-sizing: border-box; margin: 1.2em 0px 0.6em; font-weight: bold; line-height: 20.976px; font-size: 1.15em; color: #333333; font-family: Lato; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" id="note-on-randomness">Note on Randomness</h4>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">The parameters of your neural network will be randomly initialized, and data in some tasks will be presented in shuffled order. Due to this randomness, it's possible that you will still occasionally fail some tasks even with a strong architecture – this is the problem of local optima! This should happen very rarely, though – if when testing your code you fail the autograder twice in a row for a question, you should explore other architectures.</p>
<h4 style="box-sizing: border-box; margin: 1.2em 0px 0.6em; font-weight: bold; line-height: 20.976px; font-size: 1.15em; color: #333333; font-family: Lato; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" id="practical-tips">Practical tips</h4>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Designing neural nets can take some trial and error. Here are some tips to help you along the way:</p>
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;">Be systematic. Keep a log of every architecture you've tried, what the hyperparameters (layer sizes, learning rate, etc.) were, and what the resulting performance was. As you try more things, you can start seeing patterns about which parameters matter. If you find a bug in your code, be sure to cross out past results that are invalid due to the bug.</li>
<li style="box-sizing: border-box;">Start with a shallow network (just two layers, i.e. one non-linearity). Deeper networks have exponentially more hyperparameter combinations, and getting even a single one wrong can ruin your performance. Use the small network to find a good learning rate and layer size; afterwards you can consider adding more layers of similar size.</li>
<li style="box-sizing: border-box;">
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">If your learning rate is wrong, none of your other hyperparameter choices matter. You can take a state-of-the-art model from a research paper, and change the learning rate such that it performs no better than random. A learning rate too low will result in the model learning too slowly, and a learning rate too high may cause loss to diverge to infinity. Begin by trying different learning rates while looking at how the loss decreases over time.</p>
</li>
<li style="box-sizing: border-box;">
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Smaller batches require lower learning rates. When experimenting with different batch sizes, be aware that the best learning rate may be different depending on the batch size.</p>
</li>
<li style="box-sizing: border-box;">Refrain from making the network too wide (hidden layer sizes too large) If you keep making the network wider accuracy will gradually decline, and computation time will increase quadratically in the layer size – you're likely to give up due to excessive slowness long before the accuracy falls too much. The full autograder for all parts of the project takes 2-12 minutes to run with staff solutions; if your code is taking much longer you should check it for efficiency.</li>
<li style="box-sizing: border-box;">If your model is returning Infinity or NaN, your learning rate is probably too high for your current architecture.</li>
<li style="box-sizing: border-box;">
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Recommended values for your hyperparameters:</p>
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;">Hidden layer sizes: between 10 and 400.</li>
<li style="box-sizing: border-box;">Batch size: between 1 and the size of the dataset. For Q2 and Q3, we require that total size of the dataset be evenly divisible by the batch size.</li>
<li style="box-sizing: border-box;">Learning rate: between 0.001 and 1.0.</li>
<li style="box-sizing: border-box;">Number of hidden layers: between 1 and 3.</li>
</ul>
</li>
</ul>

## Page 6 (book)

@ Reading

<h2 style="font-family: Quicksand; font-weight: bold; text-align: left; margin-bottom:1rem;">Provided Code (Part II)</h2>

<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Here is a full list of nodes available in <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.py</code>. You will make use of these in the remaining parts of the assignment:</p>
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.Constant</code> represents a matrix (2D array) of floating point numbers. It is typically used to represent input features or target outputs/labels. Instances of this type will be provided to you by other functions in the API; you will not need to construct them directly.</li>
<li style="box-sizing: border-box;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.Parameter</code> represents a trainable parameter of a perceptron or neural network. All parameters must be 2-dimensional.
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;">Usage: <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.Parameter(n, m)</code> constructs a parameter with shape $ n \times m$</li>
</ul>
</li>
<li style="box-sizing: border-box;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.Add</code> adds matrices element-wise.
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;">Usage: <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.Add(x, y)</code> accepts two nodes of shape $ \text{batch_size} \times \text{num_features}$ and constructs a node that also has shape $ \text{batch_size} \times \text{num_features}$.</li>
</ul>
</li>
<li style="box-sizing: border-box;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.AddBias</code> adds a bias vector to each feature vector.
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;">Usage: <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.AddBias(features, bias)</code> accepts <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">features</code> of shape $ \text{batch_size} \times \text{num_features}$ and <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">bias</code>of shape $ 1 \times \text{num_features}$, and constructs a node that has shape $ \text{batch_size} \times \text{num_features}$.</li>
</ul>
</li>
<li style="box-sizing: border-box;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.Linear</code> applies a linear transformation (matrix multiplication) to the input.
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;">Usage: <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.Linear(features, weights)</code> accepts <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">features</code> of shape $ \text{batch_size} \times \text{num_input_features}$ and <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">weights</code>of shape $ \text{num_input_features} \times \text{num_output_features}$, and constructs a node that has shape $ \text{batch_size} \times \text{num_output_features}$.</li>
</ul>
</li>
<li style="box-sizing: border-box;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.ReLU</code> applies the element-wise Rectified Linear Unit nonlinearity $ relu(x) = \max(x, 0)$. This nonlinearity replaces all negative entries in its input with zeros.
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;">Usage: <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.ReLU(features)</code>, which returns a node with the same shape as the <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">input</code>.</li>
</ul>
</li>
<li style="box-sizing: border-box;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.SquareLoss</code> computes a batched square loss, used for regression problems
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;">Usage: <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.SquareLoss(a, b)</code>, where <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">a</code> and <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">b</code> both have shape $ \text{batch_size} \times \text{num_outputs}$.</li>
</ul>
</li>
<li style="box-sizing: border-box;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.SoftmaxLoss</code> computes a batched softmax loss, used for classification problems.
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;">Usage: <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.SoftmaxLoss(logits, labels)</code>, where <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">logits</code> and <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">labels</code> both have shape $ \text{batch_size} \times \text{num_classes}$. The term “logits” refers to scores produced by a model, where each entry can be an arbitrary real number. The labels, however, must be non-negative and have each row sum to 1. Be sure not to swap the order of the arguments!</li>
</ul>
</li>
<li style="box-sizing: border-box;"><em style="box-sizing: border-box;">Do not use <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.DotProduct</code> for any model other than the perceptron.</em></li>
</ul>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">The following methods are available in <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.py</code>:</p>
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.gradients</code> computes gradients of a loss with respect to provided parameters.
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;">Usage: <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.gradients(loss, [parameter_1, parameter_2, ..., parameter_n])</code> will return a list <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">[gradient_1, gradient_2, ..., gradient_n]</code>, where each element is an <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.Constant</code> containing the gradient of the loss with respect to a parameter.</li>
</ul>
</li>
<li style="box-sizing: border-box;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.as_scalar</code> can extract a Python floating-point number from a loss node. This can be useful to determine when to stop training.
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;">Usage: <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.as_scalar(node)</code>, where <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">node</code> is either a loss node or has shape <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">(1,1)</code>.</li>
</ul>
</li>
</ul>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">The datasets provided also have two additional methods:</p>
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">dataset.iterate_forever(batch_size)</code> yields an infinite sequences of batches of examples.</li>
<li style="box-sizing: border-box;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">dataset.get_validation_accuracy()</code> returns the accuracy of your model on the validation set. This can be useful to determine when to stop training.</li>
</ul>

## Page 7 (book)

@ Reading

<h2 style="font-family: Quicksand; font-weight: bold; text-align: left; margin-bottom:1rem;">Example: Linear Regression</h2>

<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">As an example of how the neural network framework works, let's fit a line to a set of data points. We'll start four points of training data constructed using the function $  y = 7x_0 + 8x_1 + 3 $. In batched form, our data is:</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">$
\mathbf{X} = \begin{bmatrix}
    0 &amp; 0 \\ 0 &amp; 1 \\ 1 &amp; 0 \\ 1 &amp; 1
\end{bmatrix} \quad$ and $\quad  \mathbf{Y} = \begin{bmatrix}
    3 \\ 11 \\ 10 \\ 18
\end{bmatrix}$</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Suppose the data is provided to us in the form of <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.Constant</code> nodes:</p>
<div class="language-python highlighter-rouge">
<div class="highlight">
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
<div class="language-python highlighter-rouge" style="box-sizing: border-box; overflow-wrap: break-word; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #f9f7f5; text-decoration-style: initial; text-decoration-color: initial;">
<div class="highlight" style="box-sizing: border-box; overflow-wrap: break-word; background: #f8f8f8; position: relative;">
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;"><span class="o" style="box-sizing: border-box;">&gt;&gt;&gt;</span> <span class="n" style="box-sizing: border-box;">x</span>
<span class="o" style="box-sizing: border-box;">&lt;</span><span class="n" style="box-sizing: border-box;">Constant</span> <span class="n" style="box-sizing: border-box;">shape</span><span class="o" style="box-sizing: border-box;">=</span><span class="mi" style="box-sizing: border-box; color: #005cc5;">4</span><span class="n" style="box-sizing: border-box;">x2</span> <span class="n" style="box-sizing: border-box;">at</span> <span class="mh" style="box-sizing: border-box; color: #005cc5;">0x10a30fe80</span><span class="o" style="box-sizing: border-box;">&gt;</span>
<span class="o" style="box-sizing: border-box;">&gt;&gt;&gt;</span> <span class="n" style="box-sizing: border-box;">y</span>
<span class="o" style="box-sizing: border-box;">&lt;</span><span class="n" style="box-sizing: border-box;">Constant</span> <span class="n" style="box-sizing: border-box;">shape</span><span class="o" style="box-sizing: border-box;">=</span><span class="mi" style="box-sizing: border-box; color: #005cc5;">4</span><span class="n" style="box-sizing: border-box;">x1</span> <span class="n" style="box-sizing: border-box;">at</span> <span class="mh" style="box-sizing: border-box; color: #005cc5;">0x10a30fef0</span><span class="o" style="box-sizing: border-box;">&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Let's construct and train a model of the form $  f(x) = x_0 \cdot m_0 + x_1 \cdot m_1 +b $. If done correctly, we should be able to learn than $ m_0 = 7$, $ m_1 = 8 $, and $ b = 3$.</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">First, we create our trainable parameters. In matrix form, these are:</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">$ \mathbf{M} = \left[ \begin{array}{c} m_0 \\ m_1 \end{array}\right] \quad$ and $ \quad\mathbf{B} = \left[ \begin{array}{c} b \end{array}\right]$</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Which corresponds to the following code:</p>
<div class="language-python highlighter-rouge">
<div class="highlight">
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;"><span class="n" style="box-sizing: border-box;">m</span> <span class="o" style="box-sizing: border-box;">=</span> <span class="n" style="box-sizing: border-box;">nn</span><span class="o" style="box-sizing: border-box;">.</span><span class="n" style="box-sizing: border-box;">Parameter</span><span class="p" style="box-sizing: border-box;">(</span><span class="mi" style="box-sizing: border-box; color: #005cc5;">2</span><span class="p" style="box-sizing: border-box;">,</span> <span class="mi" style="box-sizing: border-box; color: #005cc5;">1</span><span class="p" style="box-sizing: border-box;">)</span>
<span class="n" style="box-sizing: border-box;">b</span> <span class="o" style="box-sizing: border-box;">=</span> <span class="n" style="box-sizing: border-box;">nn</span><span class="o" style="box-sizing: border-box;">.</span><span class="n" style="box-sizing: border-box;">Parameter</span><span class="p" style="box-sizing: border-box;">(</span><span class="mi" style="box-sizing: border-box; color: #005cc5;">1</span><span class="p" style="box-sizing: border-box;">,</span> <span class="mi" style="box-sizing: border-box; color: #005cc5;">1</span><span class="p" style="box-sizing: border-box;">)</span></code></pre>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
</div>
</div>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Printing them gives:</p>
<div class="language-python highlighter-rouge">
<div class="highlight">
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;"><span class="o" style="box-sizing: border-box;">&gt;&gt;&gt;</span> <span class="n" style="box-sizing: border-box;">m</span>
<span class="o" style="box-sizing: border-box;">&lt;</span><span class="n" style="box-sizing: border-box;">Parameter</span> <span class="n" style="box-sizing: border-box;">shape</span><span class="o" style="box-sizing: border-box;">=</span><span class="mi" style="box-sizing: border-box; color: #005cc5;">2</span><span class="n" style="box-sizing: border-box;">x1</span> <span class="n" style="box-sizing: border-box;">at</span> <span class="mh" style="box-sizing: border-box; color: #005cc5;">0x112b8b208</span><span class="o" style="box-sizing: border-box;">&gt;</span>
<span class="o" style="box-sizing: border-box;">&gt;&gt;&gt;</span> <span class="n" style="box-sizing: border-box;">b</span>
<span class="o" style="box-sizing: border-box;">&lt;</span><span class="n" style="box-sizing: border-box;">Parameter</span> <span class="n" style="box-sizing: border-box;">shape</span><span class="o" style="box-sizing: border-box;">=</span><span class="mi" style="box-sizing: border-box; color: #005cc5;">1</span><span class="n" style="box-sizing: border-box;">x1</span> <span class="n" style="box-sizing: border-box;">at</span> <span class="mh" style="box-sizing: border-box; color: #005cc5;">0x112b8beb8</span><span class="o" style="box-sizing: border-box;">&gt;</span></code></pre>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
</div>
</div>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Next, we compute our model's predictions for y:</p>
<div class="language-python highlighter-rouge">
<div class="highlight">
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;"><span class="n" style="box-sizing: border-box;">xm</span> <span class="o" style="box-sizing: border-box;">=</span> <span class="n" style="box-sizing: border-box;">nn</span><span class="o" style="box-sizing: border-box;">.</span><span class="n" style="box-sizing: border-box;">Linear</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">x</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">m</span><span class="p" style="box-sizing: border-box;">)</span>
<span class="n" style="box-sizing: border-box;">predicted_y</span> <span class="o" style="box-sizing: border-box;">=</span> <span class="n" style="box-sizing: border-box;">nn</span><span class="o" style="box-sizing: border-box;">.</span><span class="n" style="box-sizing: border-box;">AddBias</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">xm</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">b</span><span class="p" style="box-sizing: border-box;">)</span></code></pre>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
</div>
</div>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Our goal is to have the predicted y-values match the provided data. In linear regression we do this by minimizing the square loss: $  \mathcal{L} = \frac{1}{2N} \sum_{(x, y)} (y - f(x))^2 $</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">We construct a loss node:</p>
<div class="language-python highlighter-rouge">
<div class="highlight">
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;"><span class="n" style="box-sizing: border-box;">loss</span> <span class="o" style="box-sizing: border-box;">=</span> <span class="n" style="box-sizing: border-box;">nn</span><span class="o" style="box-sizing: border-box;">.</span><span class="n" style="box-sizing: border-box;">SquareLoss</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">predicted_y</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">y</span><span class="p" style="box-sizing: border-box;">)</span></code></pre>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
</div>
</div>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">In our framework, we provide a method that will return the gradients of the loss with respect to the parameters:</p>
<div class="language-python highlighter-rouge">
<div class="highlight">
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;"><span class="n" style="box-sizing: border-box;">grad_wrt_m</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">grad_wrt_b</span> <span class="o" style="box-sizing: border-box;">=</span> <span class="n" style="box-sizing: border-box;">nn</span><span class="o" style="box-sizing: border-box;">.</span><span class="n" style="box-sizing: border-box;">gradients</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">loss</span><span class="p" style="box-sizing: border-box;">,</span> <span class="p" style="box-sizing: border-box;">[</span><span class="n" style="box-sizing: border-box;">m</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">b</span><span class="p" style="box-sizing: border-box;">])</span></code></pre>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
</div>
</div>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Printing the nodes used gives:</p>
<div class="language-python highlighter-rouge">
<div class="highlight">
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;"><span class="o" style="box-sizing: border-box;">&gt;&gt;&gt;</span> <span class="n" style="box-sizing: border-box;">xm</span>
<span class="o" style="box-sizing: border-box;">&lt;</span><span class="n" style="box-sizing: border-box;">Linear</span> <span class="n" style="box-sizing: border-box;">shape</span><span class="o" style="box-sizing: border-box;">=</span><span class="mi" style="box-sizing: border-box; color: #005cc5;">4</span><span class="n" style="box-sizing: border-box;">x1</span> <span class="n" style="box-sizing: border-box;">at</span> <span class="mh" style="box-sizing: border-box; color: #005cc5;">0x11a869588</span><span class="o" style="box-sizing: border-box;">&gt;</span>
<span class="o" style="box-sizing: border-box;">&gt;&gt;&gt;</span> <span class="n" style="box-sizing: border-box;">predicted_y</span>
<span class="o" style="box-sizing: border-box;">&lt;</span><span class="n" style="box-sizing: border-box;">AddBias</span> <span class="n" style="box-sizing: border-box;">shape</span><span class="o" style="box-sizing: border-box;">=</span><span class="mi" style="box-sizing: border-box; color: #005cc5;">4</span><span class="n" style="box-sizing: border-box;">x1</span> <span class="n" style="box-sizing: border-box;">at</span> <span class="mh" style="box-sizing: border-box; color: #005cc5;">0x11c23aa90</span><span class="o" style="box-sizing: border-box;">&gt;</span>
<span class="o" style="box-sizing: border-box;">&gt;&gt;&gt;</span> <span class="n" style="box-sizing: border-box;">loss</span>
<span class="o" style="box-sizing: border-box;">&lt;</span><span class="n" style="box-sizing: border-box;">SquareLoss</span> <span class="n" style="box-sizing: border-box;">shape</span><span class="o" style="box-sizing: border-box;">=</span><span class="p" style="box-sizing: border-box;">()</span> <span class="n" style="box-sizing: border-box;">at</span> <span class="mh" style="box-sizing: border-box; color: #005cc5;">0x11c23a240</span><span class="o" style="box-sizing: border-box;">&gt;</span>
<span class="o" style="box-sizing: border-box;">&gt;&gt;&gt;</span> <span class="n" style="box-sizing: border-box;">grad_wrt_m</span>
<span class="o" style="box-sizing: border-box;">&lt;</span><span class="n" style="box-sizing: border-box;">Constant</span> <span class="n" style="box-sizing: border-box;">shape</span><span class="o" style="box-sizing: border-box;">=</span><span class="mi" style="box-sizing: border-box; color: #005cc5;">2</span><span class="n" style="box-sizing: border-box;">x1</span> <span class="n" style="box-sizing: border-box;">at</span> <span class="mh" style="box-sizing: border-box; color: #005cc5;">0x11a8cb160</span><span class="o" style="box-sizing: border-box;">&gt;</span>
<span class="o" style="box-sizing: border-box;">&gt;&gt;&gt;</span> <span class="n" style="box-sizing: border-box;">grad_wrt_b</span>
<span class="o" style="box-sizing: border-box;">&lt;</span><span class="n" style="box-sizing: border-box;">Constant</span> <span class="n" style="box-sizing: border-box;">shape</span><span class="o" style="box-sizing: border-box;">=</span><span class="mi" style="box-sizing: border-box; color: #005cc5;">1</span><span class="n" style="box-sizing: border-box;">x1</span> <span class="n" style="box-sizing: border-box;">at</span> <span class="mh" style="box-sizing: border-box; color: #005cc5;">0x11a8cb588</span><span class="o" style="box-sizing: border-box;">&gt;</span></code></pre>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
</div>
</div>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">We can then use the <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">update</code> method to update our parameters. Here is an update for <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">m</code>, assuming we have already initialized a <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">multiplier</code> variable based on a suitable learning rate of our choosing:</p>
<div class="language-python highlighter-rouge">
<div class="highlight">
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;"><span class="n" style="box-sizing: border-box;">m</span><span class="o" style="box-sizing: border-box;">.</span><span class="n" style="box-sizing: border-box;">update</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">grad_wrt_m</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">multiplier</span><span class="p" style="box-sizing: border-box;">)</span></code></pre>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
</div>
</div>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">If we also include an update for <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">b</code> and add a loop to repeatedly perform gradient updates, we will have the full training procedure for linear regression.</p>
<div id="gtx-trans" style="position: absolute; left: 258px; top: 1538.82px;">
<div class="gtx-trans-icon"></div>
</div>

## Page 8 (book)

@ Reading

<h2 style="font-family: Quicksand; font-weight: bold; text-align: left; margin-bottom:1rem;">Question 2 (6 points): Non-linear Regression</h2>

<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">For this question, you will train a neural network to approximate $  \sin(x)$ over $ [-2\pi, 2\pi]$.</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">You will need to complete the implementation of the <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">RegressionModel</code> class in <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">models.py</code>. For this problem, a relatively simple architecture should suffice (see Neural Network Tips for architecture tips.) Use <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.SquareLoss</code> as your loss.</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Your tasks are to:</p>
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;">Implement <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">RegressionModel.__init__</code> with any needed initialization</li>
<li style="box-sizing: border-box;">Implement <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">RegressionModel.run</code> to return a $ \text{batch_size}  \times  1$ node that represents your model's prediction.</li>
<li style="box-sizing: border-box;">Implement <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">RegressionModel.get_loss</code> to return a loss for given inputs and target outputs.</li>
<li style="box-sizing: border-box;">Implement <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">RegressionModel.train</code>, which should train your model using gradient-based updates.</li>
</ul>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">There is only a single dataset split for this task (i.e., there is only training data and no validation data or test set). Your implementation will receive full points if it gets a loss of 0.02 or better, averaged across all examples in the dataset. You may use the training loss to determine when to stop training (use <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.as_scalar</code> to convert a loss node to a Python number). Note that it should take the model a few minutes to train.</p>
<div class="language-shell highlighter-rouge">
<div class="highlight">
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;">python autograder.py <span class="nt" style="box-sizing: border-box; color: #22863a;">-q</span> q2</code></pre>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
</div>
</div>

## Page 9 (book)

@ Reading

<h2 style="font-family: Quicksand; font-weight: bold; text-align: left; margin-bottom:1rem;">Question 3 (6 points): Digit Classification</h2>

<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">For this question, you will train a network to classify handwritten digits from the MNIST dataset.</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Each digit is of size $ 28\times28$ pixels, the values of which are stored in a $ 784$-dimensional vector of floating point numbers. Each output we provide is a 10-dimensional vector which has zeros in all positions, except for a one in the position corresponding to the correct class of the digit.</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Complete the implementation of the <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">DigitClassificationModel</code> class in <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">models.py</code>. The return value from <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">DigitClassificationModel.run()</code> should be a $ \text{batch_size} \times 10$ node containing scores, where higher scores indicate a higher probability of a digit belonging to a particular class (0-9). You should use <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.SoftmaxLoss</code> as your loss. Do not put a ReLU activation after the last layer of the network.</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">For both this question and Q4, in addition to training data, there is also validation data and a test set. You can use <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">dataset.get_validation_accuracy()</code> to compute validation accuracy for your model, which can be useful when deciding whether to stop training. The test set will be used by the autograder.</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">To receive points for this question, your model should achieve an accuracy of at least 97% on the test set. For reference, our staff implementation consistently achieves an accuracy of 98% on the validation data after training for around 5 epochs. Note that the test grades you on <strong>test accuracy</strong>, while you only have access to <strong>validation accuracy</strong> - so if your validation accuracy meets the 97% threshold, you may still fail the test if your test accuracy does not meet the threshold. Therefore, it may help to set a slightly higher stopping threshold on validation accuracy, such as 97.5% or 98%.</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">To test your implementation, run the autograder:</p>
<div class="language-shell highlighter-rouge">
<div class="highlight">
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;">python autograder.py <span class="nt" style="box-sizing: border-box; color: #22863a;">-q</span> q3</code></pre>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
</div>
</div>
<div id="gtx-trans" style="position: absolute; left: -37px; top: 554.042px;">
<div class="gtx-trans-icon"></div>
</div>

## Page 10 (book)

@ Reading

<h2 style="font-family: Quicksand; font-weight: bold; text-align: left; margin-bottom:1rem;">Question 4 (7 points): Language Identification</h2>

<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Language identification is the task of figuring out, given a piece of text, what language the text is written in. For example, your browser might be able to detect if you've visited a page in a foreign language and offer to translate it for you. Here is an example from Chrome (which uses a neural network to implement this feature):</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><img src="https://inst.eecs.berkeley.edu/~cs188/sp20/assets/images/chrometrans.png" alt="translation suggestion in chrome" /></p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">In this project, we're going to build a smaller neural network model that identifies language for one word at a time. Our dataset consists of words in five languages, such as the table below:</p>
<table class="table table-bordered" style="box-sizing: border-box; border-collapse: collapse; border: 1px solid #dee2e6; width: 392px; margin-bottom: 1rem; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial; height: 237px;">
<tbody style="box-sizing: border-box;">
<tr style="box-sizing: border-box;">
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top; text-align: center;"><b style="box-sizing: border-box; font-weight: bolder;">Word</b></td>
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top; text-align: center;"><b style="box-sizing: border-box; font-weight: bolder;">Language</b></td>
</tr>
<tr style="box-sizing: border-box;">
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top; text-align: center;">discussed</td>
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top; text-align: center;">English</td>
</tr>
<tr style="box-sizing: border-box;">
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top; text-align: center;">eternidad</td>
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top; text-align: center;">Spanish</td>
</tr>
<tr style="box-sizing: border-box;">
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top; text-align: center;">itseänne</td>
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top; text-align: center;">Finnish</td>
</tr>
<tr style="box-sizing: border-box;">
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top; text-align: center;">paleis</td>
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top; text-align: center;">Dutch</td>
</tr>
<tr style="box-sizing: border-box;">
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top; text-align: center;">mieszkać</td>
<td style="box-sizing: border-box; border: 1px solid #dee2e6; padding: 0.75rem; vertical-align: top; text-align: center;">Polish</td>
</tr>
</tbody>
</table>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><br />Different words consist of different numbers of letters, so our model needs to have an architecture that can handle variable-length inputs. Instead of a single input $ x$ (like in the previous questions), we'll have a separate input for each character in the word: $  x_0, x_1, \ldots, x_{L-1} $ where $ L$ is the length of the word. We'll start by applying a network $  f_{\text{initial}} $ that is just like the feed-forward networks in the previous problems. It accepts its input $  x_0 $ and computes an output vector $  h_1 $ of dimensionality $  d $:</p>
<div style="text-align: center;">$ h_1 = f_{\text{initial}}(x_0)$</div>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Next, we'll combine the output of the previous step with the next letter in the word, generating a vector summary of the the first two letters of the word. To do this, we'll apply a sub-network that accepts a letter and outputs a hidden state, but now also depends on the previous hidden state $  h_1 $. We denote this sub-network as $  f $.</p>
<div style="text-align: center;">$ h_2 = f(h_1, x_1)$</div>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">This pattern continues for all letters in the input word, where the hidden state at each step summarizes all the letters the network has processed thus far:</p>
<div style="text-align: center;">$ h_3 = f(h_2, x_2)$</div>
<div style="text-align: center;">$ \vdots$</div>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Throughout these computations, the function $ f(\cdot, \cdot)$ is the same piece of neural network and uses the same trainable parameters; $  f_{\text{initial}} $ will also share some of the same parameters as $ f(\cdot, \cdot)$. In this way, the parameters used when processing words of different length are all shared. You can implement this using a <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">for</code> loop over the provided inputs <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">xs</code>, where each iteration of the loop computes either $ f_{\text{initial}}$ or $ f$.</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">The technique described above is called a Recurrent Neural Network (RNN). A schematic diagram of the RNN is shown below:</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: center; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><img src="https://inst.eecs.berkeley.edu/~cs188/sp20/assets/images/rnn.png" alt="RNN network architecture" width="385" height="182" /></p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Here, an RNN is used to encode the word “cat” into a fixed-size vector $ h_3$.</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">After the RNN has processed the full length of the input, it has <em style="box-sizing: border-box;">encoded</em> the arbitrary-length input word into a fixed-size vector $ h_L$, where $ L$ is the length of the word. This vector summary of the input word can now be fed through additional output layers to generate classification scores for the word's language identity.</p>
<h4 style="box-sizing: border-box; margin: 1.2em 0px 0.6em; font-weight: bold; line-height: 20.976px; font-size: 1.15em; color: #333333; font-family: Lato; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" id="batching">Batching</h4>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Although the above equations are in terms of a single word, in practice you must use batches of words for efficiency. For simplicity, our code in the project ensures that all words within a single batch have the same length. In batched form, a hidden state $  h_i $ is replaced with the matrix $  H_i $ of dimensionality $  \text{batch_size} \times d $.</p>
<h4 style="box-sizing: border-box; margin: 1.2em 0px 0.6em; font-weight: bold; line-height: 20.976px; font-size: 1.15em; color: #333333; font-family: Lato; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" id="design-tips">Design Tips</h4>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">The design of the recurrent function $  f(h,x) $ is the primary challenge for this task. Here are some tips:</p>
<ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">
<li style="box-sizing: border-box;">Start with a feed-forward architecture $  f_{\text{initial}}(x) $ of your choice, as long as it has at least one non-linearity.</li>
<li style="box-sizing: border-box;">You should use the following method of constructing $  f(h, x) $ given $  f_{\text{initial}}(x) $. The first layer of $  f_{\text{initial}} $ will begin by multiplying the vector $  x_0 $ by some weight matrix $  \mathbf{W} $ to produce $  z_0 = x_0 \cdot \mathbf{W} $. For subsequent letters, you should replace this computation with $  z_i = x_i \mathbf{W} + h_i \mathbf{W}_{\text{hidden}} $ using an <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">nn.Add</code> operation. In other words, you should replace a computation of the form <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">z = nn.Linear(x, W)</code> with a computation of the form <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">z = nn.Add(nn.Linear(x, W), nn.Linear(h, W_hidden))</code>.</li>
<li style="box-sizing: border-box;">If done correctly, the resulting function $  f $ will be non-linear in both $ x$ and $ h$</li>
<li style="box-sizing: border-box;">The hidden size $ d$ should be sufficiently large</li>
<li style="box-sizing: border-box;">Start with a shallow network for $ f$, and figure out good values for the hidden size and learning rate before you make the network deeper. If you start with a deep network right away you will have exponentially more hyperparameter combinations, and getting any single hyperparameter wrong can cause your performance to suffer dramatically.</li>
</ul>
<h4 style="box-sizing: border-box; margin: 1.2em 0px 0.6em; font-weight: bold; line-height: 20.976px; font-size: 1.15em; color: #333333; font-family: Lato; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" id="your-task">Your task</h4>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Complete the implementation of the <code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: 14.44px; color: #1e90ff; word-break: break-word; white-space: nowrap; background-color: #f0f7ff; padding: 1px 4px; border-radius: 5px; border: 1px solid rgba(30, 144, 255, 0.5);" class="highlighter-rouge">LanguageIDModel</code> class.</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">To receive full points on this problem, your architecture should be able to achieve an accuracy of at least 81% on the test set.</p>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">To test your implementation, run the autograder:</p>
<div class="language-shell highlighter-rouge">
<div class="highlight">
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
<pre class="highlight" style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier; font-size: 14.44px; margin-top: 0px; margin-bottom: 12px; overflow: auto; display: block; color: #212529; background: #f8f8f8; border: 1px solid #cccccc; border-radius: 8px; padding: 1.2em 1.5em; line-height: 1.4em; white-space: pre; word-break: inherit; overflow-wrap: inherit; -webkit-font-smoothing: subpixel-antialiased; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><code style="box-sizing: border-box; font-family: Inconsolata, Menlo, Monaco, 'Courier New', Courier, monospace; font-size: inherit; color: inherit; word-break: normal; white-space: pre-wrap; background-color: transparent; padding: 0px; border-radius: 0px; border: none;">python autograder.py <span class="nt" style="box-sizing: border-box; color: #22863a;">-q</span> q4</code></pre>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" re="" class="highlight"></p>
</div>
</div>
<p style="box-sizing: border-box; margin: 0.5rem 0px; line-height: 1.5em; color: #212529; font-family: Lato; font-size: 15.2px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;"><strong>Disclaimer:</strong> This dataset was generated using automated text processing. It may contain errors. It has also not been filtered for profanity. However, our reference implementation can still correctly classify over 89% of the validation set despite the limitations of the data. Our reference implementation takes 10-20 epochs to train.</p>
<div id="gtx-trans" style="position: absolute; left: -29px; top: 2156.21px;">
<div class="gtx-trans-icon"></div>
</div>
